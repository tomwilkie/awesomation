<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]-->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <title>Awesomation</title>

  <link rel="shortcut icon" href="/static/imgs/favicon.png">

  <link rel='stylesheet' type='text/css' href='http://fonts.googleapis.com/css?family=Indie+Flower'>
  <link rel="stylesheet" type="text/css" href="/static/css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="/static/css/glyphicons-bootstrap.css">
  <link rel="stylesheet" type="text/css" href="/static/css/glyphicons.css">
  <link rel="stylesheet" type="text/css" href="/static/css/screen.css">

  <script type="text/javascript" src="/static/js/jquery.js"></script>
  <script type="text/javascript" src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
  <script type="text/javascript" src="//js.pusher.com/2.2/pusher.min.js"></script>
  <script type="text/javascript" src="/static/js/jquery.ba-bbq.js"></script>
  <script type="text/javascript" src="/static/js/sprintf.js"></script>
  <script type="text/javascript" src="/static/js/handlebars.js"></script>
  <script type="text/javascript" src="/static/js/bootstrap.js"></script>
  <script type="text/javascript" src="/static/js/moment.js"></script>
  <script type="text/javascript" src="/static/js/app.js"></script>
</head>
<body>
  <div class="modal fade" id="main_modal" tabindex="-1" role="dialog" aria-hidden="true">
  </div>

  <script type="text/x-handlebars-template" id="setup-auto-dimming-dialog-template">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">Configure auto dimming</h4>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">
            <div class="form-group">
                <div class="col-sm-offset-4 col-sm-8">
                  <div class="checkbox">
                    <label>
                      <input type="checkbox" id="enable-auto-dim" {{#if auto_dim_lights}}checked{{/if}}> Enable auto dimming
                    </label>
                  </div>
                </div>
              </div>
            <div class="form-group">
              <label for="inputEmail3" class="col-sm-4 control-label">Start time (hh:mm)</label>
              <div class="col-sm-3">
                <input type="number" class="form-control" id="start-hours" placeholder="16"
                       min="0" max="23" value="{{ExtractHours dim_start_time}}">
              </div>
              <div class="col-sm-1 text-center">:</div>
              <div class="col-sm-3">
                <input type="number" class="form-control" id="start-mins" placeholder="00"
                       min="0" max="59" value="{{ExtractMinutes dim_start_time}}">
              </div>
            </div>
            <div class="form-group">
              <label for="inputPassword3" class="col-sm-4 control-label">End time (hh:mm)</label>
              <div class="col-sm-3">
                <input type="number" class="form-control" id="end-hours" placeholder="16"
                       min=0 max=23 value="{{ExtractHours dim_end_time}}">
              </div>
              <div class="col-sm-1 text-center">:</div>
              <div class="col-sm-3">
                <input type="number" class="form-control" id="end-mins" placeholder="00"
                       min=0 max=59 value="{{ExtractMinutes dim_end_time}}">
              </div>
            </div>
            <div class="form-group">
              <label for="target-brightnes" class="col-sm-4 control-label">Target Brightness:</label>
              <div class="col-sm-8">
                <input type="range" id="target-brightness" value="{{target_brightness}}"
                       min="0" max="255">
              </div>
            </div>
            <div class="form-group">
              <label for="target-color-temperature" class="col-sm-4 control-label">Target Color Temp:</label>
              <div class="col-sm-8">
                <input type="range" id="target-color-temperature"
                       value="{{InvertColorTemp target_color_temperature}}"
                       min="0" max="347">
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars-template" id="room-change-name-dialog-template">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">Change room name</h4>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">
            <div class="form-group">
              <label for="room-name" class="col-sm-3 control-label">Room name:</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" id="room-name" value="{{Name this}}">
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary">Change room name</button>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars-template" id="delete-room-dialog-template">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-body">
          <p>Are you sure you want to delete room '{{Name this}}'?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary">Delete room</button>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars-template" id="create-new-room-dialog-template">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">Create new room</h4>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">
            <div class="form-group">
              <label for="room-name" class="col-sm-3 control-label">Room name:</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" id="room-name">
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary">Create new room</button>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars-template" id="device-change-room-dialog-template">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">Change room</h4>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">
            <div class="form-group">
              <label for="room" class="col-sm-3 control-label">Room name:</label>
              <div class="col-sm-8">
                <select id="room" class="form-control">
                  {{#NameSort rooms}}
                  <option value="{{id}}"{{#IfEquals ../device.room id}} selected{{/IfEquals}}>{{Name this}}</option>
                  {{/NameSort}}
                </select>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary">Change room</button>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars-template" id="device-change-name-dialog-template">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">Change device name</h4>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">
            <div class="form-group">
              <label for="device-name" class="col-sm-3 control-label">Device name:</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" id="device-name" value="{{Name this}}">
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary">Change name</button>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars-template" id="delete-device-dialog-template">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-body">
          <p>Are you sure you want to delete device '{{Name this}}'?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary">Delete device</button>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars-template" id="delete-account-dialog-template">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-body">
          <p>Are you sure you want to delete this {{human_type}} account?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary">Delete account</button>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars-template" id="new-device-dialog-template">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">Add new device</h4>
        </div>
        <div class="modal-body">
          <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingOne">
                <h4 class="panel-title">
                  <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                    Philips Hue bridges & bulbs
                  </a>
                </h4>
              </div>
              <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                <div class="panel-body">
                  Philips Hue bridges & bulbs are automatically detected and added.  You need to press the pair button on the
                  Hue bridge and then select scan on the Hue bridge menu.
                </div>
              </div>
            </div>
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingTwo">
                <h4 class="panel-title">
                  <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    Belkin Wemo switches
                  </a>
                </h4>
              </div>
              <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                <div class="panel-body">
                   Belkin Wemo switches are automatically detected and added.
                </div>
              </div>
            </div>
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingThree">
                <h4 class="panel-title">
                  <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                    433Mhz RF switches
                  </a>
                </h4>
              </div>
              <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                <div class="panel-body">
                  <form class="form-horizontal">
                    <p>433Mhz switches are configured with a set of dip switches on their reverse.  The first 5 switches
                    specify the system code, and the next 5 the device number.  Enter the system code (eg 010101) and
                    device number (eg 1) below.  NB 433Mhz switches require an Awesomation Proxy.</p>

                    <div class="form-group">
                      <label class="col-sm-3 control-label" for="device-name">Name</label>
                      <div class="col-sm-5">
                        <input type="text" class="form-control" id="device-name" placeholder="Device Name">
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="col-sm-3 control-label" for="room" >Room</label>
                      <div class="col-sm-5">
                        <select id="room" class="form-control">
                          {{#NameSort rooms}}
                          <option value="{{id}}">{{Name this}}</option>
                          {{/NameSort}}
                        </select>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="col-sm-3 control-label" for="system-code">System Code</label>
                      <div class="col-sm-5">
                        <input type="text" class="form-control" id="system-code" placeholder="System Code">
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="col-sm-3 control-label" for="device-code">Device Code</label>
                      <div class="col-sm-5">
                        <input type="number" min="0" max="4" step="1" value="0" class="form-control" id="device-code">
                      </div>
                    </div>
                    <div class="error_placeholder">
                    </div>
                    <div class="pull-right">
                      <button type="button" class="btn btn-primary" data-type='rfswitch'>Create device</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingThree">
                <h4 class="panel-title">
                  <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
                    ZWave Devices
                  </a>
                </h4>
              </div>
              <div id="collapseSix" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFive">
                <div class="panel-body">
                  Zwave devices are automatically added when you pair the hardware (ie using physical buttons).
                </div>
              </div>
            </div>
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingThree">
                <h4 class="panel-title">
                  <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseSeven" aria-expanded="false" aria-controls="collapseSeven">
                    iPhones
                  </a>
                </h4>
              </div>
              <div id="collapseSeven" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFive">
                <div class="panel-body">
                  <form class="form-horizontal">
                    <p>By adding your iPhones's MAC address below, your Awesomation proxy can track the presence
                      of your iPhone on your wifi network, and use this to indicate your presence in the house.
                      Your iPhone's MAC address can be found under Settings &gt; General &gt; About, referred to as the
                      'Wi-Fi Address'.</p>

                    <div class="form-group">
                      <label class="col-sm-3 control-label" for="network-device-name">Name</label>
                      <div class="col-sm-5">
                        <input type="text" class="form-control" id="network-device-name" placeholder="Device Name">
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="col-sm-3 control-label" for="mac-address">MAC Address</label>
                      <div class="col-sm-5">
                        <input type="text" class="form-control" id="mac-address" placeholder="MAC Address">
                      </div>
                    </div>
                    <div class="error_placeholder">
                    </div>
                    <div class="pull-right">
                      <button type="button" class="btn btn-primary" data-type='network'>Create device</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingThree">
                <h4 class="panel-title">
                  <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseEight" aria-expanded="false" aria-controls="collapseEight">
                    Awesomation Proxy
                  </a>
                </h4>
              </div>
              <div id="collapseEight" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingEight">
                <div class="panel-body">
                  <form class="form-horizontal">
                    <p>Awesomation proxies are identified by a unique ID (found in the logs, printed at startup).
                      To add an awesomation proxy, enter that ID below.</p>

                    <div class="form-group">
                      <label class="col-sm-3 control-label" for="proxy-id">Proxy ID</label>
                      <div class="col-sm-5">
                        <input type="text" class="form-control" id="proxy-id" placeholder="Proxy ID">
                      </div>
                    </div>
                    <div class="error_placeholder">
                    </div>
                    <div class="pull-right">
                      <button type="button" class="btn btn-primary" data-type='proxy'>Create device</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingThree">
                <h4 class="panel-title">
                  <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                    Nest devices
                  </a>
                </h4>
              </div>
              <div id="collapseFour" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFour">
                <div class="panel-body">
                  Nest devices are automatically added once you add your Nest account.
                  <a href="/api/account/start_flow?type=nest" target="_new">Click here to add a Nest account.</a>
                </div>
              </div>
            </div>
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="headingThree">
                <h4 class="panel-title">
                  <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                    Netatmo devices
                  </a>
                </h4>
              </div>
              <div id="collapseFive" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFive">
                <div class="panel-body">
                  Netatmo devices are automatically added once you add your Netatmo account.
                  <a href="/api/account/start_flow?type=netatmo" target="_new">Click here to add a Netatmo account.</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars-template" id="error-template">
    <div class="alert alert-danger" role="alert" id='proxy-error'>
      <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
      <span class="sr-only">Error:</span>
      {{message}}
    </div>
  </script>

  <script type="text/x-handlebars-template" class="handlebars-partial" id="loading">
    <div class='row text-center'><i><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>  Loading...</i></div>
  </script>

  <script type="text/x-handlebars-template" class="handlebars-partial" id="device">
    <div class="device card" data-device-id="{{id}}">
      <div class="content">
        <div class="watermark"><span class="glyphicons {{IconFor category}} x4" aria-hidden="true"></span></div>
        <div class="device-name">{{Name this}}</div>
        <div class="device-details">
          {{#HasCapability 'PRESENCE'}}
          {{#if present}}
          <span class="label label-success">present: yes</span>
          {{else}}
          <span class="label label-warning">present: no</span>
          {{/if}}
          {{/HasCapability}}

          {{#HasCapability 'SWITCH'}}
          {{#if state}}
          <span class="label label-success">state: on</span>
          {{else}}
          <span class="label label-warning">state: off</span>
          {{/if}}
          {{/HasCapability}}

          {{#HasCapability 'DIMMABLE'}}
          {{#if state}}
          <span class="label label-success">brigthness: {{PercentOf brightness 255}}%</span>
          {{else}}
          <span class="label label-warning">brightness: {{PercentOf brightness 255}}%</span>
          {{/if}}
          {{/HasCapability}}

          {{#Category 'CLIMATE'}}
          {{#if temperature}} <span class="label label-success">Temperature: {{Float temperature}}C</span>{{/if}}
          {{#if humidity}} <span class="label label-success">Humidity: {{Int humidity}}%</span>{{/if}}
          {{#if co2}} <span class="label label-success">CO<sub>2</sub>: {{Int co2}} ppm</span>{{/if}}
          {{#if pressure}} <span class="label label-success">Pressure: {{Int pressure}} mb</span>{{/if}}
          {{#if noise}} <span class="label label-success">Noise: {{Int noise}} db</span>{{/if}}
          {{#if lux}} <span class="label label-success">Brigthness: {{Int lux}} lux</span>{{/if}}
          {{/Category}}

          {{#Category 'MUSIC'}}
          {{#IfEquals state 'PLAYING'}}
          <span class="label label-success">
            playing: {{currently_playing.title}} by {{currently_playing.artist}}
          </span>
          {{else}}
          <span class="label label-warning">paused</span>
          {{/IfEquals}}
          {{/Category}}
        </div>
      </div>
      <div class="btn-group btn-group" role="group" aria-label="...">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          <span class="glyphicon glyphicon-cog" aria-hidden="true"></span> <span class="caret"></span>
        </button>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
          {{#HasCapability 'SCAN'}}
          <li><a href="#" class="device-command" data-command="scan">Scan</a></li>
          {{/HasCapability}}

          {{#HasCapability 'SWITCH'}}
          {{#if state}}
          <li><a href="#" class="device-set" data-key="state" data-value="false">Turn off</a></li>
          {{else}}
          <li><a href="#" class="device-set" data-key="state" data-value="true">Turn on</a></li>
          {{/if}}
          {{/HasCapability}}

          {{#HasCapability 'DIMMABLE'}}
          <li><a href="#">
            <div class="menucontrol">
              <span class="glyphicon glyphicon glyphicon-adjust"></span>
              <input class="on-change-device-set" data-key="brightness" type="range"
                     min="0" max="255" value="{{brightness}}">
            </div>
          </a></li>
          {{/HasCapability}}

          {{#HasCapability 'COLOR_TEMPERATURE'}}
          <li><a href="#">
            <div class="menucontrol">
              <span class="glyphicon glyphicon glyphicon-tint"></span>
              <input class="on-change-device-set" data-key="color-temperature" type="range"
                     min="0" max="347" value="{{InvertColorTemp color_temperature}}"
                     data-modify="reverse_color_temp">
            </div>
          </a></li>
          {{/HasCapability}}

          {{#HasCapability 'PRESENCE'}}
          {{#if present}}
          <li><a href="#" class="device-set" data-key="present" data-value="false">Fake Absent</a></li>
          {{else}}
          <li><a href="#" class="device-set" data-key="present" data-value="true">Fake Present</a></li>
          {{/if}}
          {{/HasCapability}}

          <li class="divider"></li>
          <li><a href="#" class='device-change-room'>Change room</a></li>
          <li><a href="#" class='device-change-name'>Change name</a></li>
          <li><a href="#" class='device-delete'>Delete</a></li>
        </ul>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars-template" id="devices-template">
    {{#if loading}}
      {{> loading}}
    {{else}}

    <div class="row">
    {{#IsEmpty objects.device}}
      <p class="help">No devices?  Use the cog in the top right to add some.</p>
    {{else}}
      {{#IsEmpty objects.room}}
        <p class="help">No rooms?  Use the cog in the top right to add some.</p>
      {{/IsEmpty}}
    {{/IsEmpty}}

    {{#HomelessDevices}}
      <div class="room col-xs-6 col-sm-4 col-lg-2">
        {{> device}}
      </div>
    {{/HomelessDevices}}
    </div>

    <div class="row devices">
      {{#NameSort objects.room}}
      <div class="room col-xs-6 col-sm-4 col-lg-2" data-room-id="{{id}}">

        <div class="room-name">
          <div>{{Name this}}</div>
          <div class="btn-group btn-group" role="group" aria-label="...">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
              <span class="glyphicon glyphicon-cog" aria-hidden="true"></span> <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right" role="menu">
              <li><a href="#" class='room-change-name'>Change name</a></li>
              <li><a href="#" class='room-delete'>Delete</a></li>
            </ul>
          </div>
        </div>

        {{#RoomHasDevicesInCategory "LIGHTING"}}
        <div class="device card">
          <div class="content">
            <div class="watermark">
              <span class="glyphicons glyphicons-lightbulb x4" aria-hidden="true"></span>
            </div>
            <div class="device-name">Lighting</div>
            <div class="device-details">
              {{#CategoryInfo 'LIGHTING'}}
                {{#if state}}
                  <span class="label label-success">state: on</span>
                  {{#if show_brightness}}
                    <span class="label label-success">brigthness: {{PercentOf brightness 255}}%</span>
                  {{/if}}
                  {{else}}
                  <span class="label label-warning">state: off</span>
                  {{#if show_brightness}}
                    <span class="label label-warning">brightness: {{PercentOf brightness 255}}%</span>
                  {{/if}}
                {{/if}}
              {{/CategoryInfo}}
            </div>
          </div>
          <div class="btn-group btn-group" role="group" aria-label="...">
            <button type="button" class="btn lighting-toggle">
              <span class="glyphicon glyphicon-off" aria-hidden="true"></span>
            </button>
            <button type="button" class="btn state-set" data-key="show-lighting-{{id}}"
                data-value="{{#IfRoomExpandCapability @root.state 'lighting'}}false{{else}}true{{/IfRoomExpandCapability}}">
              {{#IfRoomExpandCapability @root.state 'lighting'}}
                <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
              {{else}}
                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
              {{/IfRoomExpandCapability}}
            </button>
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
              <span class="glyphicon glyphicon-cog" aria-hidden="true"></span> <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right" role="menu">
              <li><a href="#" class="configure-auto-dim">Configure auto dimming</a></li>
              <li><a href="#">
                <div class="menucontrol">
                  <span class="glyphicon glyphicon glyphicon-adjust"></span>
                  <input class="on-change-device-set" data-key="brightness" type="range"
                         min="0" max="255" value="{{brightness}}">
                </div>
              </a></li>
            </ul>
          </div>
        </div>

        {{#IfRoomExpandCapability @root.state 'lighting'}}
          <div class="devices">
          {{#DevicesInCategory 'LIGHTING'}}
            {{> device}}
          {{/DevicesInCategory}}
          </div>
        {{/IfRoomExpandCapability}}
        {{/RoomHasDevicesInCategory}}

        {{#RoomHasDevicesInCategory "CLIMATE"}}
        <div class="device card">
          <div class="content">
            <div class="watermark">
              <span class="glyphicons glyphicons-cloud x4" aria-hidden="true"></span>
            </div>
            <div class="device-name">Climate</div>
            <div class="device-details">
              {{#CategoryInfo 'CLIMATE'}}
                {{#if temperature}}
                  <span class="label label-success">Temperature: {{Float temperature}}C</span>
                {{/if}}
                {{#if temperature-max}}
                  <span class="label label-success">Temperature: {{Float temperature-min}}
                    - {{Float temperature-max}} C</span>
                {{/if}}
                {{#if humidity}}
                  <span class="label label-success">Humidity: {{Int humidity}}%</span>
                {{/if}}
                {{#if humidity-max}}
                  <span class="label label-success">Humidity: {{Int humidity-min}}
                    - {{Int humidity-max}} %</span>
                {{/if}}
                {{#if co2}}
                  <span class="label label-success">CO<sub>2</sub>: {{Int co2}} ppm</span>
                {{/if}}
                {{#if co2-max}}
                  <span class="label label-success">CO<sub>2</sub>: {{Int co2-min}}
                    - {{Int co2-max}} ppm</span>
                {{/if}}
                {{#if pressure}}
                  <span class="label label-success">Pressure: {{Int pressure}} mb</span>
                {{/if}}
                {{#if pressure-max}}
                  <span class="label label-success">Pressure: {{Int pressure-min}}
                    - {{Int pressure-max}} mb</span>
                {{/if}}
                {{#if noise}}
                  <span class="label label-success">Noise: {{Int noise}} db</span>
                {{/if}}
                {{#if noise-max}}
                  <span class="label label-success">Noise: {{Int noise-min}}
                    - {{Int noise-max}} db</span>
                {{/if}}
                {{#if lux}}
                  <span class="label label-success">Brigthness: {{Int lux}} lux</span>
                {{/if}}
                {{#if lux-max}}
                  <span class="label label-success">Brigthness: {{Int lux-min}} - {{Int lux-max}} lux</span>
                {{/if}}
              {{/CategoryInfo}}
            </div>
          </div>
          <div class="btn-group btn-group" role="group" aria-label="...">
            <button type="button" class="btn state-set" data-key="show-climate-{{id}}"
                data-value="{{#IfRoomExpandCapability @root.state 'climate'}}false{{else}}true{{/IfRoomExpandCapability}}">
              {{#IfRoomExpandCapability @root.state 'climate'}}
                <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
              {{else}}
                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
              {{/IfRoomExpandCapability}}
            </button>
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
              <span class="glyphicon glyphicon-cog" aria-hidden="true"></span> <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right" role="menu">
              <li><a href="#" class='disabled'>Empty</a></li>
            </ul>
          </div>
        </div>

        {{#IfRoomExpandCapability @root.state 'climate'}}
          <div class="devices">
          {{#DevicesInCategory 'CLIMATE'}}
            {{> device}}
          {{/DevicesInCategory}}
          </div>
        {{/IfRoomExpandCapability}}
        {{/RoomHasDevicesInCategory}}

        {{#RoomHasDevicesInCategory "MUSIC"}}
        <div class="device card">
          <div class="content">
            <div class="watermark">
              <span class="glyphicons glyphicons-music x4" aria-hidden="true"></span>
            </div>
            <div class="device-name">Music</div>
            <div class="device-details">
              {{#DevicesInCategory 'MUSIC'}}
                {{#Category 'MUSIC'}}
                {{#IfEquals state 'PLAYING'}}
                <span class="label label-success">
                  playing: {{currently_playing.title}} by {{currently_playing.artist}}
                </span>
                {{else}}
                <span class="label label-warning">paused</span>
                {{/IfEquals}}
                {{/Category}}
              {{/DevicesInCategory}}
            </div>
          </div>
          <div class="btn-group btn-group" role="group" aria-label="...">
            <button type="button" class="btn state-set" data-key="show-music-{{id}}"
                data-value="{{#IfRoomExpandCapability @root.state 'music'}}false{{else}}true{{/IfRoomExpandCapability}}">
              {{#IfRoomExpandCapability @root.state 'music'}}
                <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
              {{else}}
                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
              {{/IfRoomExpandCapability}}
            </button>
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
              <span class="glyphicon glyphicon-cog" aria-hidden="true"></span> <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right" role="menu">
              <li><a href="#" class='disabled'>Empty</a></li>
            </ul>
          </div>
        </div>

        {{#IfRoomExpandCapability @root.state 'music'}}
          <div class="devices">
          {{#DevicesInCategory 'MUSIC'}}
            {{> device}}
          {{/DevicesInCategory}}
          </div>
        {{/IfRoomExpandCapability}}
        {{/RoomHasDevicesInCategory}}

        {{#DevicesNotInCategories}}
          {{> device}}
        {{/DevicesNotInCategories}}
      </div>

      {{#IfMod @index 2}}
      <div class="clearfix visible-xs-block"></div>
      {{/IfMod}}

      {{#IfMod @index 3}}
      <div class="clearfix visible-sm-block visible-md-block"></div>
      {{/IfMod}}

      {{#IfMod @index 6}}
      <div class="clearfix visible-lg-block"></div>
      {{/IfMod}}
    {{/NameSort}}
    </div>
    {{/if}}
  </script>

  <script type="text/x-handlebars-template" id="accounts-template">
    {{#if loading}}
      {{> loading}}
    {{else}}
    {{#IsEmpty objects.account}}
      <p class="help">No accounts?  Add third party services list Nest and Netatmo
        by clicking the cog in the top right.</p>
    {{/IsEmpty}}

    {{#NameSort objects.account}}
    <div class="row">
      <div class="col-xs-12 room">
        <div class="account card"  data-account-id="{{id}}">
          <h4>
            {{human_type}} account

            <div class="btn-group btn-group-xs pull-right" role="group">
              <button type="button" class="btn btn-default delete-account">
                <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                Delete
              </button>
              <button type="button" class="btn btn-default account-command" data-command="refresh_devices">
                <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
                Refresh
              </button>
            </div>
          </h4>

          <p>Last updated: {{HumanTime last_updated}}</p>
          <p>Devices: {{#DevicesForAccount id}}{{Name this}}{{else}}<i>None</i>{{/DevicesForAccount}}</p>
        </div>
      </div>
    </div>
    {{/NameSort}}
    {{/if}}
  </script>

  <div>
    <div class="header">
      <h1>Awesomation</h1>

      <div class="btn-group pull-right" role="group">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          <span class="glyphicon glyphicon-cog" aria-hidden="true"></span> <span class="caret"></span>
        </button>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
          <li><a href="#" class='create-new-room'>Create new room</a></li>
          <li><a href="#" class='add-new-device'>Add new device</a></li>
        </ul>
      </div>

      <ul class="nav nav-pills">
        <li class="active" data-mode="devices"><a href="#">
          Rooms
        </a></li>
        <li data-mode="accounts"><a href="#">Accounts <span class="sr-only">(current)</span></a></li>
      </ul>
    </div>
    <div id="main" class="container-fluid">
    </div>
  </div>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-58176356-1', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>
